<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lucija Batinović">

<title>Analysis plan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="revision_analysis_plan_files/libs/clipboard/clipboard.min.js"></script>
<script src="revision_analysis_plan_files/libs/quarto-html/quarto.js"></script>
<script src="revision_analysis_plan_files/libs/quarto-html/popper.min.js"></script>
<script src="revision_analysis_plan_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="revision_analysis_plan_files/libs/quarto-html/anchor.min.js"></script>
<link href="revision_analysis_plan_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="revision_analysis_plan_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="revision_analysis_plan_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="revision_analysis_plan_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="revision_analysis_plan_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis plan</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lucija Batinović </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="synthesis-plan" class="level2">
<h2 class="anchored" data-anchor-id="synthesis-plan">Synthesis plan</h2>
<p>We will conduct an individual participant data meta-analysis, by modelling a Bayesian, beta-binomial hierarchical regression. Our effect size will be presented as odds ratio between baseline and intervention phase, which represents the trend and variability aspects of SCED analysis according to WWC guidelines. The analyses will be performed in R (R Core Team, 2023; R version 4.3.1), using the brms (Bürkner, 2017) package, an R wrapper for the probabilistic programming language Stan (Stan Development Team, 2024). We will conduct separate analyses for each category of reading interventions, as we do not consider them conceptually homogeneous enough to aggregate in one model. Likewise, we will group the analyses based on designs that can be synthesized in the same model. In the first group, we will aggregate multiple baseline (and its variants), multiple probe designs and changing criterion designs. We consider these designs similar in logic, and as long as the intervention and outcome are kept homogeneous, we can model the variations in measurement and intervention setup across stages as random variation. In the second group, we will aggregate alternating phase designs (i.e., AB designs). The third group will consist of multiple treatments. With three groups based on design, and three interventions (phonological awareness, fluency, and phonics), we anticipate nine main meta-analytic models. We will not model interventions categorized as other as we expect that category to be overly heterogeneous.</p>
<p>We will model the baseline and intervention phase separately in our main meta-analysis model, with interaction with time (session). We will also not model autocorrelation. Although the literature suggests the existence of moderate autocorrelation, particularly in multiple-baseline designs (Shadish, 2011), we could model it exploratory only due to unknown estimates.</p>
<p>We will plot the posterior distributions of the average intervention effect (fixed effect) and the interaction effect between session and intervention, along with the posterior distributions of the random-effects estimates to assess heterogeneity in intervention effects between studies and between participants within studies. Heterogeneity will be quantified using the posterior distributions of the standard deviations (SDs) of the random effects for the intervention phase at both the between-study and between-participant levels, as well as the standard deviation of the session-by-intervention interaction effect. We will provide estimates with 90% credible intervals for each effect, allowing readers to understand both the average intervention impact and the variability of effects across different studies and participants.</p>
<p>Level one of the multilevel model describes the relationship between the outcome - word or non-word reading, and the predictor - reading intervention. Informed by previous reviews with similar interest, we assume majority of the studies will employ non-standardized word-reading tests, with counts and percentages as measures, and fixed word lists, as we assume the existence of autocorrelation (but will not model it explicitly) and knowledge transfer, we cannot assume the trials are independent. To allow for greater flexibility and account for over-dispersion (i.e., variance being larger than the mean), and to account for unavailable raw counts in instances where the studies present proportion of correct responses, we will model the outcome under the beta-binomial distribution (Gelman et al., 2020). Figure 1 illustrates the multiple levels in a meta-analysis.</p>
<p>To calculate the effect for our meta-analysis, we need to account for clusters on the levels we specified in the beginning: participant and study. There are two ways to approach when we have raw data - calculate average effects per study and do a meta-analysis of those effects (which is the common way of conducting a meta-analysis when you don’t have raw data) or build a model that directly calculates the population (average) effect from the raw data. We will do the latter, one stage approach.</p>
<p>Thus, our starting model is as follows:</p>
<p><span class="math display">\[
Y_{ijk} \sim BetaBin(N_{ijk}, \mu_{ijk}, \theta)
\]</span></p>
<p>Beta-binomial distribution can be explained as a binomial distribution that has its probability parameter informed by the beta distribution of probabilities. <span class="math inline">\(Y_{ijk}\)</span> represents the correct response rate for each individual (j) within a study (k) at a certain time point i = 1, …, n.&nbsp;<span class="math inline">\(BetaBin\)</span> indicates the observations are drawn from a beta-binomial distribution which has the <span class="math inline">\(N_{ijk}\)</span> parameter for the number of trials, <span class="math inline">\(\mu_{ijk}\)</span> for the average probability (Some authors denote it as pbar; McElreath, 2020) of the beta distribution and <span class="math inline">\(\theta\)</span> as the dispersion (precision) parameter of the beta distribution (some authors might note it as <span class="math inline">\(\phi\)</span>; Burkner, 2017).</p>
<p><span class="math display">\[
\text{logit}(\mu_{ijk}) = \alpha + \beta_1 ID_{j} + \beta_2 \text{session}_{i} + g_{jk} + g_k
\]</span></p>
<p>where: - <span class="math inline">\(\alpha\)</span> is the global intercept, - <span class="math inline">\(\beta_1\)</span> represents the main effect of ID (i.e., intervention phase), - <span class="math inline">\(\beta_2\)</span> represents the main effect of session (i.e., measurement occasions), - <span class="math inline">\(g_{jk}\)</span> is the participant-level random effect nested within the study, - <span class="math inline">\(g_k\)</span> is the study-level random effect.</p>
<p>Next parameters we have to specify for the Bayesian model would be the priors for the distribution parameters.We take the first function and add a prior for the average probability parameter (<span class="math inline">\(\mu\)</span>) which is a log odds probability of success (<span class="math inline">\(\alpha_{treatment[i]}\)</span>), with the <span class="math inline">\(treatment\)</span> index implying whether it’s baseline or intervention. We draw the <span class="math inline">\(\alpha\)</span> from a normal distribution with a <span class="math inline">\(mean\)</span> of 0 and <span class="math inline">\(SD\)</span> of 1.5. The choice of the distribution is relatively arbitrary, we can assume that the odds parameter can be drawn from a normal distribution, but parameters are up to us to define based on previous knowledge.</p>
<p>The multilevel model now specifies random effects on the participant (<span class="math inline">\(g_{j}\)</span>) and study level (<span class="math inline">\(g_{k}\)</span>). We also define parameters for priors for the means and standard deviations. As these effects are interdependent, the model also produces a correlation matrix to explain the covariance. Weakly informative priors drawn from a Student-t or a Cauchy distribution have been recommended by Gelman (2006) for hierarchical models, particularly when the number of groups is larger than 3, which we expect in our meta-analyses. Degrees of freedom were selected to allow flexibility but constrain the values, based on evidence by Brehm et al.&nbsp;(2021).</p>
<p>Furthermore, we will incorporate immediate level changes and time trends through session effects and their interaction with intervention. This allows us to capture both immediate shifts and gradual changes during intervention. The model includes random slopes for both session and intervention × session effects at both study and case levels, enabling us to detect heterogeneity in learning trajectories across studies and participants.</p>
<p>LKJ, the Lewandowski-Kurowicka-Joe distribution is a probability distribution over positive-definite symmetric matrices with unit diagonals, i.e., correlation matrices (Gelman, 2020). We use this distribution as a prior for the correlation matrix of effects in the model and set it as <span class="math inline">\(LKJcorr(2)\)</span> of 2, which makes extreme correlations less likely in the correlation matrix, but still allows for correlations between the effects (McElreath, 2020).\</p>
<p>We draw standard deviations from the half-student-t distributions, instead of normal, as it allows the possibility of extreme (tail) values, which helps us accommodate to uncertainty of these values. By defining it as “half”, we constrain the distribution only to positive values for the SD.\</p>
<p>Given the way that the designs are bounding the possible answers to a small range, and often conduct interventions until 100% success rate is achieved, we can expect ceiling effects, large effects in the intervention phase and larger improvements (slope) for those with lower baseline results.</p>
<p>The hierarchical structure of the random effects follows:</p>
<p><span class="math display">\[
g_{jk} \sim \mathcal{N}(0, \sigma_{j[k]})
\]</span></p>
<p><span class="math display">\[
g_k \sim \mathcal{N}(0, \sigma_{study})
\]</span></p>
<p>where: - <span class="math inline">\(g_{jk}\)</span> accounts for variability among cases within studies, - <span class="math inline">\(g_{k}\)</span> accounts for variability across studies, - <span class="math inline">\(\sigma_{j[k]}\)</span> and <span class="math inline">\(\sigma_{k}\)</span> are the standard deviations at each level.</p>
<p>The variance components follow a hierarchical prior:</p>
<p><span class="math display">\[
\sigma_{study} \sim \text{Half-Student}(3, 0, 2.5)
\]</span></p>
<p><span class="math display">\[
\sigma_{case[k]} \sim \text{Half-Student}(3, 0, 2.5)
\]</span></p>
<p><span class="math display">\[
\mathbf{R} \sim LKJcorr(2)
\]</span></p>
<p><span class="math display">\[
\alpha \sim \text{Student}(3, 3.9, 2.5)
\]</span></p>
<p><span class="math display">\[
\beta_1, \beta_2, \sim \text{Student}(3, 0, 2.5)
\]</span></p>
<p><span class="math display">\[
\theta = \Phi
\]</span></p>
<p><span class="math display">\[
\Phi \sim gamma(1,1)
\]</span></p>
<section id="moderator-analysis" class="level3">
<h3 class="anchored" data-anchor-id="moderator-analysis">Moderator analysis</h3>
<p>We will conduct a moderator analysis based on IQ, as findings by Allor et al.&nbsp;(2014) suggest that lower IQ is linked to lower rates of reading development. Given the way that the designs are bounding the possible answers to a small range, and often conduct interventions until 100% success rate is achieved, we can expect ceiling effects, large effects in the intervention phase and larger improvements (slope) for those with lower baseline results. \ We will introduce IQ as a continuous predictor in the main model, centered around the group mean. While grand-mean centering might be appropriate given that it is one population of participants, in this case, group-mean centering is preferable due to the likely non-random selection of intellectual disability (ID) severity within studies. Specifically, the selection of participants with a particular severity level (e.g., mild intellectual disability) may influence the intervention complexity. If IQ were centered around the grand mean, this study-level selection bias could distort estimates, making group-mean centering a more appropriate choice to account for within-study variability.</p>
<p><span class="math display">\[
logit(\mu) = \alpha_{treatment[i]}*\beta_{session[t]} + \gamma_{IQ[j]} + g_{participant[j]} + g_{study[k]}
\]</span> <span class="math display">\[
\gamma_{IQ[j]} \sim N(\mu_{IQ[j]}, \sigma_{IQ[j]})
\]</span></p>
<p>We will include IQ as a continuous variable rather than using categorical ID severity, as a continuous measure provides more granular and informative modeling of variation. Additionally, there are potentially two types of missing values:\</p>
<p>Missing (completely) at random — where IQ scores are either not reported or not permitted for sharing.\ Missing not at random - where IQ scores are unavailable because participants could not be reliably tested due to the severity of their disability.</p>
<p>If the data is not missing at random, we will not conduct a moderator analysis. In case of an M(C)AR type missingness, we will impute the values with the mice package.</p>
</section>
</section>
<section id="model-building-workflow" class="level2">
<h2 class="anchored" data-anchor-id="model-building-workflow">Model building workflow</h2>
<p>We have pre-specified possible alternatives for the models, based on assumptions about the outcome data and intervention characteristics. However, as we do not have data at the moment of specifying the models, we propose a workflow to determine which model will be selected as the main model once we obtain the data.</p>
<p>We will graphically inspect the data to estimate the growth curve based on sessions, to determine whether time influences the outcome linearly or exponentially.</p>
<p>Table X presents alternate priors and functions of the predictors that we will apply to the data and test the model fit. We will select the best model for each meta-analysis as the main model and provide results of the other model alternatives as a sensitivity analysis. Suggested informative priors come from Pustejovsky et al.&nbsp;(2025), although the priors they specified fith the baseline phase only, while we also include the intervention phase.</p>
<section id="table-x" class="level4">
<h4 class="anchored" data-anchor-id="table-x">Table X</h4>
</section>
</section>
<section id="model-specifications-and-priors" class="level1">
<h1>Model Specifications and Priors</h1>
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 51%">
<col style="width: 17%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Session Specification</th>
<th>Priors</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>1A</strong></td>
<td>Linear (session)</td>
<td>Default <code>brms</code> priors</td>
<td>Baseline model</td>
</tr>
<tr class="even">
<td><strong>1B</strong></td>
<td>Linear (session)</td>
<td>- <code>Student_t(3, 0, 2.5)</code> for <code>IDIntervention</code> slope <br> - <code>Flat()</code> for <code>session</code> slope <br> - <code>Student_t(3, 3.9, 2.5)</code> for intercept <br> - <code>LKJ(2)</code> for correlations <br> - <code>Gamma(1, 1)</code> for <code>phi</code> <br> - <code>Student_t(3, 0, 2.5)</code> for all group-level SDs</td>
<td>Weakly informative priors based on literature; flat prior on session</td>
</tr>
<tr class="odd">
<td><strong>2A</strong></td>
<td>Splined (session)</td>
<td>Default <code>brms</code> priors</td>
<td>Non-linear learning trajectory using splines</td>
</tr>
<tr class="even">
<td><strong>2B</strong></td>
<td>Splined (session)</td>
<td>- <code>Student_t(3, 0, 2.5)</code> for <code>IDIntervention</code> <br> - <code>Normal(0, 0.1)</code> for spline basis coefficients (e.g., <code>ssession_1</code>, etc.) <br> - <code>Student_t(3, 3.9, 2.5)</code> for intercept <br> - <code>LKJ(2)</code> for correlations <br> - <code>Gamma(1, 1)</code> for <code>phi</code> <br> - <code>Student_t(3, 0, 2.5)</code> for group-level SDs <br> - <code>Student_t(3, 0, 2.5)</code> for spline smoothness (<code>sds</code>)</td>
<td>Informed priors; compatible with prior predictive sampling</td>
</tr>
</tbody>
</table>
<section id="initial-setup-of-the-models-and-priors" class="level3">
<h3 class="anchored" data-anchor-id="initial-setup-of-the-models-and-priors">Initial setup of the models and priors</h3>
<div class="cell">

</div>
<div class="cell">
<details>
<summary>Data setup</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data will be cleaned here for analyses. We will filter out maintenance and generalization phases for the analysis. We will also filter data based on SCED design and run all models for each category of designs. </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"analysis"</span>, <span class="st">"mydata.csv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">success_rate =</span> <span class="fu">round</span>(success_rate<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">0</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">fail_rate =</span> <span class="fu">round</span>(<span class="fu">abs</span>(fail_rate)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">!=</span> <span class="st">"Maintenance"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(case, study) <span class="sc">%&gt;%</span>  </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">session =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#data %&gt;% filter(ID == "intervention") %&gt;% ggplot(aes(x = x, y = success_rate, color = case)) +</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_point() +</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line() +</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  facet_wrap(~study, ncol = len())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code for the prior and formula setup</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regular session formula</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">&lt;-</span> <span class="fu">bf</span>(success_rate<span class="sc">|</span><span class="fu">trials</span>(success_rate <span class="sc">+</span> fail_rate) <span class="sc">~</span> session <span class="sc">+</span> ID <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ID <span class="sc">|</span> study<span class="sc">/</span>case))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sigmoid session formula</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>model_formula2 <span class="ot">&lt;-</span> <span class="fu">bf</span>(success_rate<span class="sc">|</span><span class="fu">trials</span>(success_rate <span class="sc">+</span> fail_rate) <span class="sc">~</span> <span class="fu">s</span>(session) <span class="sc">+</span> ID <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ID <span class="sc">|</span> study<span class="sc">/</span>case))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="do">## priors for default models (linear and sigmoid)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>priors_model_formula <span class="ot">&lt;-</span> <span class="fu">get_prior</span>(model_formula, <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">beta_binomial</span>())  <span class="co"># linear + default priors</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>priors_model_formula<span class="sc">$</span>prior[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"normal(0,100)"</span> <span class="co"># for prior predictive check, remove after data collection</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>priors_model_formula2 <span class="ot">&lt;-</span> <span class="fu">get_prior</span>(model_formula2, <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">beta_binomial</span>())  <span class="co"># sigmoid + default priors</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>priors_model_formula2<span class="sc">$</span>prior[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"normal(0,100)"</span> <span class="co"># for prior predictive check, remove after data collection</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Specifying informative priors for linear model (1B)</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>priors_model_formula3 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"IDIntervention"</span>),   <span class="co"># Fixed effect of intervention</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.1)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"session"</span>),                 <span class="co"># uninformative prior for session</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>),                                        <span class="co"># Prior for correlation matrices</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 3.9, 2.5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),                  <span class="co"># Intercept (baseline phase)</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"gamma(1, 1)"</span>, <span class="at">class =</span> <span class="st">"phi"</span>, <span class="at">lb =</span> <span class="dv">0</span>),                           <span class="co"># Phi (precision)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Random effects priors</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study"</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study:case"</span>),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study"</span>, <span class="at">coef =</span> <span class="st">"IDIntervention"</span>),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study"</span>, <span class="at">coef =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study:case"</span>, <span class="at">coef =</span> <span class="st">"IDIntervention"</span>),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study:case"</span>, <span class="at">coef =</span> <span class="st">"Intercept"</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Specifying informative priors for sigmoid model (2B)</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>priors_model_formula4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fixed effects</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"IDIntervention"</span>),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.1)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"ssession_1"</span>),  <span class="co"># uninformative prior</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>), <span class="co"># Correlations</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 3.9, 2.5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),   <span class="co"># Intercept baseline</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"gamma(1, 1)"</span>, <span class="at">class =</span> <span class="st">"phi"</span>, <span class="at">lb =</span> <span class="dv">0</span>),</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Random effect SDs</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study"</span>),</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study:case"</span>),</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study"</span>, <span class="at">coef =</span> <span class="st">"IDIntervention"</span>),</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study"</span>, <span class="at">coef =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study:case"</span>, <span class="at">coef =</span> <span class="st">"IDIntervention"</span>),</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study:case"</span>, <span class="at">coef =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prior for spline smooth term </span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"student_t(3, 0, 2.5)"</span>, <span class="at">class =</span> <span class="st">"sds"</span>, <span class="at">coef =</span> <span class="st">"s(session)"</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code for the models</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model 1A regular session default priors</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">beta_binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> priors_model_formula,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>), <span class="co"># fix divergent transitions</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">core =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">init_r=</span><span class="fl">0.1</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># model 1B sigmoid session default priors</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula2,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">beta_binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> priors_model_formula2,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>), <span class="co"># fix divergent transitions</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">core =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">init_r=</span><span class="fl">0.1</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            )            </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># model 2A regular session informed priors</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">beta_binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> priors_model_formula3,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>), <span class="co"># fix divergent transitions</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">core =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">init_r=</span><span class="fl">0.1</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>            )            </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># model 2B sigmoid session informed priors</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula2,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">beta_binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> priors_model_formula4,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>), <span class="co"># fix divergent transitions</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">core =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(),</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">init_r=</span><span class="fl">0.1</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-1---prior-predictive-checks" class="level3">
<h3 class="anchored" data-anchor-id="step-1---prior-predictive-checks">Step 1 - Prior Predictive Checks</h3>
<p>Figure 1 shows prior predictive checks for the 4 suggested models, based on different session function and different priors. The draws are sampled from a sample dataset of single case designs with a proportion outcome, but in a different subject, for purposes of building and testing the model before collecting real data.</p>
<div class="cell">
<details>
<summary>Prior pred check code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"red"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="do">## models are fit with sample_prior = "only" to fit the drawn samples without the observed data</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>pp_fit1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula,<span class="at">family =</span> <span class="fu">beta_binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">prior =</span> priors_model_formula, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">sample_prior =</span> <span class="st">"only"</span>, <span class="at">data =</span> data)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># model 1B sigmoid session default priors</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>pp_fit2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula2, <span class="at">family =</span> <span class="fu">beta_binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">prior =</span> priors_model_formula2, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">sample_prior =</span> <span class="st">"only"</span>, <span class="at">data =</span> data)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># model 2A regular session informed priors</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>pp_fit3 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula, <span class="at">family =</span> <span class="fu">beta_binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">prior =</span> priors_model_formula3, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">sample_prior =</span> <span class="st">"only"</span>, <span class="at">data =</span> data)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># model 2B sigmoid session informed priors</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>pp_fit4 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> model_formula2, <span class="at">family =</span> <span class="fu">beta_binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">prior =</span> priors_model_formula4, </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">sample_prior =</span> <span class="st">"only"</span>, <span class="at">data =</span> data)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>pp1 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(pp_fit1, <span class="at">prefix =</span> <span class="st">"ppd"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Fit1 - linear + default"</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>pp2 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(pp_fit2, <span class="at">prefix =</span> <span class="st">"ppd"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Fit2 - linear + informed"</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>pp3 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(pp_fit3, <span class="at">prefix =</span> <span class="st">"ppd"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Fit3 - GAM + default"</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>pp4 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(pp_fit4, <span class="at">prefix =</span> <span class="st">"ppd"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Fit4 - GAM + informed"</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>pred_plots <span class="ot">&lt;-</span> <span class="fu">list</span>(pp1, pp2, pp3, pp4)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(pred_plots, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ppd-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">prior predictive check</figcaption><p></p>
</figure>
</div>
</section>
<section id="step-2---posterior-predictive-checkes" class="level3">
<h3 class="anchored" data-anchor-id="step-2---posterior-predictive-checkes">Step 2 - Posterior Predictive Checkes</h3>
<p>Figure 2 shows posterior predictive checks for the 4 suggested models, based on different session function and different priors, but this time done on observed data after data is collected.</p>
<div class="cell">
<details>
<summary>Posterior pred check code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"blue"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ppc1 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(fit1, <span class="at">type =</span> <span class="st">"dens_overlay_grouped"</span>, <span class="at">group =</span> <span class="st">"ID"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Fit1 - linear + default"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>ppc2 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(fit2, <span class="at">type =</span> <span class="st">"dens_overlay_grouped"</span>, <span class="at">group =</span> <span class="st">"ID"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Fit2 - linear + informed"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>ppc3 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(fit3, <span class="at">type =</span> <span class="st">"dens_overlay_grouped"</span>, <span class="at">group =</span> <span class="st">"ID"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Fit3 - GAM + default"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>ppc4 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(fit4, <span class="at">type =</span> <span class="st">"dens_overlay_grouped"</span>, <span class="at">group =</span> <span class="st">"ID"</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Fit4 - GAM + informed"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>post_pred_plots <span class="ot">&lt;-</span> <span class="fu">list</span>(ppc1, ppc2, ppc3, ppc4)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(post_pred_plots, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ppc-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">prior predictive check</figcaption><p></p>
</figure>
</div>
</section>
<section id="step-3---model-comparisons-loo-and-waic" class="level3">
<h3 class="anchored" data-anchor-id="step-3---model-comparisons-loo-and-waic">Step 3 - Model Comparisons (LOO and WAIC)</h3>
<p>We will conduct leave-one-out cross validation, and its expansion, the Watanabe-Aikake (widely applicable; WAIC) information criterion, to select the best fitted model for the meta-analysis. Based on Gelman et al.&nbsp;(2014), LOO and WAIC are more appropriate for partial or complete pooling models. Interpretation will be done based on the WAIC and LOO scores, with the lowest out-of-sample deviance being the criteria for selecting the best fitting model.</p>
<div class="cell">
<details>
<summary>Model comparison code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit1_ic <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit1, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fit1_waic <span class="ot">&lt;-</span> <span class="fu">waic</span>(fit1)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>fit2_ic <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit2, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>fit2_waic <span class="ot">&lt;-</span> <span class="fu">waic</span>(fit2)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>fit3_ic <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit3, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>fit3_waic <span class="ot">&lt;-</span> <span class="fu">waic</span>(fit3)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>fit4_ic <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit4, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>fit4_waic <span class="ot">&lt;-</span> <span class="fu">waic</span>(fit4)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(fit1_waic, fit2_waic, fit3_waic, fit4_waic) </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(w, <span class="at">simplify =</span> F)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(fit1_ic, fit2_ic, fit3_ic, fit4_ic) <span class="co"># leave-one-out cross validation</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(l, <span class="at">simplify =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-4---moderator-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-4---moderator-analysis">Step 4 - Moderator Analysis</h3>
<div class="cell">
<details>
<summary>Moderator analysis code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we will center IQ with group mean and model with random slopes</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#data_iq &lt;- data %&gt;% </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  group_by(study) %&gt;% </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(IQ = IQ - mean(IQ, na.rm = TRUE)) %&gt;% </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  ungroup()</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#formula_iq &lt;- bf(success_rate|trials(success_rate + fail_rate) ~ session + ID + IQ + (1 + ID | study/case))</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#prior_iq &lt;- get_prior(formula = formula_iq, </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                   data = data_iq, </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                   family = beta_binomial())</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#fit_iq &lt;- brm(formula = formula_iq, </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                 data = data_iq, </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                 family = beta_binomial(link = "logit"),</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                 prior = prior_iq, </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                 warmup = 1000, iter = 4000,</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                 cores = parallel::detectCores()</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#          )</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(fit_iq)</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#posterior predictive check for baseline and intervention fit</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#pp_check(fit_iq, type = "dens_overlay_grouped", group = "ID", ndraws = 100)</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(fit_iq)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>